<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8' />
  <title>Showcase | Wayfarer</title>
  <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.0/jquery.min.js"></script>
  <script src='https://api.mapbox.com/mapbox-gl-js/v2.0.1/mapbox-gl.js'></script>
  <link href='https://api.mapbox.com/mapbox-gl-js/v2.0.1/mapbox-gl.css' rel='stylesheet' />
  <script src='https://npmcdn.com/csv2geojson@latest/csv2geojson.js'></script>
  <script src='https://npmcdn.com/@turf/turf/turf.min.js'></script>
  <style>
    body {
      margin: 0;
      padding: 0;
    }
    #map {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 100%;
    }
    .mapboxgl-popup {
      padding-bottom: 5px;
    }
    .mapboxgl-popup-close-button {
      display: none;
    }
    .mapboxgl-popup-content {
      font: 400 15px/22px 'Source Sans Pro', 'Helvetica Neue', Sans-serif;
      padding: 0;
      width: 500px;
    }
    .mapboxgl-popup-content-wrapper {
      padding: 1%;
    }
    .mapboxgl-popup-content h3 {
      background: rgb(61, 59, 59);
      text-align: center;
      color: #fff;
      margin: 0;
      display: block;
      padding: 15px;
      font-weight: 700;
      margin-top: -5px;
    }
    .mapboxgl-popup-content h4 {
      margin: 0;
      display: block;
      padding: 10px 3px 10px 10px;
      font-weight: 400;
    }
    .mapboxgl-popup-content img {
      width: 100%;
    }
    .mapboxgl-container {
      cursor: pointer;
    }
    .mapboxgl-popup-anchor-top>.mapboxgl-popup-content {
      margin-top: 3px;
    }
    .mapboxgl-popup-anchor-top>.mapboxgl-popup-tip {
      border-bottom-color: rgb(61, 59, 59);
    }
    #menu {
      position: absolute;
      background: #efefef;
      padding: 5px;
      font-family: 'Open Sans', sans-serif;
    }
    #map { 
      position: absolute; 
      top: 0; bottom: 0; 
      width: 100%; }
  </style>
</head>
<body>
  <style> 
    #map { 
      position: absolute; 
      top: 0; bottom: 0; 
      width: 100%; }
  </style>  
  <div id='map'></div>

<div id="menu">
<ul>
  <li type="disc"><a href="https://docs.google.com/spreadsheets/d/1ry2hwuzi-SArBQhrsDAP9LTJHBbi3hAyWGo9a4JBxfI/edit?usp=sharing">データ (スプレッドシート)</a></li>
  <li type="disc"><a href="https://forms.gle/JbQJandHtdTSoeLp8">データ登録用フォーム</a></li>
</ul>
  </div>

  <script>
  var transformRequest = (url, resourceType) => {
    var isMapboxRequest = url.slice(8, 22) === "api.mapbox.com" || url.slice(10, 26) === "tiles.mapbox.com";
    return {
      url: isMapboxRequest ? url.replace("?", "?pluginName=sheetMapper&") : url
    };
  };
  mapboxgl.accessToken = 'pk.eyJ1IjoieW9naHVydG9uIiwiYSI6ImNrMWMzaTRodTAwMXkzbG5wdXJvMXFuYXoifQ.7TYzn64qL5_Kktp--kX6Dw';
  var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/yoghurton/cksn875dm2ivp17poo64eew9m',
    center: [140.084556, 36.104611],
    zoom: 4.5,
    transformRequest: transformRequest
  });
    
  
  $(document).ready(function () {

    $.ajax({
      type: "GET",
      url: 'https://docs.google.com/spreadsheets/d/1ry2hwuzi-SArBQhrsDAP9LTJHBbi3hAyWGo9a4JBxfI/gviz/tq?tqx=out:csv&sheet=map data',
      dataType: "text",
      success: function (csvData) {
        makeGeoJSON(csvData);
      }
    });

    function makeGeoJSON(csvData) {
      csv2geojson.csv2geojson(csvData, {
        latfield: 'lat',
        lonfield: 'lng',
        delimiter: ','
      }, function (err, data) {
        map.on('load', function () {
          map.addSource("cells", {
            "type": "geojson",
            "data": {
              "type": "FeatureCollection",
              "features": [{
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [123.078901, 23.274622],
                    [124.508523, 22.929281],
                    [124.508523, 24.258610],
                    [123.078901, 24.619021],
                    [123.078901, 23.274622]
                  ]
                },
                "properties": {
                  "cell": "AS13-PAPA-00"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [121.628310, 23.610040],
                    [123.078901, 23.274622],
                    [123.078901, 24.619021],
                    [121.628310, 24.968878],
                    [121.628310, 23.610040]
                  ]
                },
                "properties": {
                  "cell": "AS13-PAPA-03"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [123.078901, 24.619021],
                    [124.508523, 24.258610],
                    [124.508523, 25.585725],
                    [123.078901, 25.960395],
                    [123.078901, 24.619021]
                  ]
                },
                "properties": {
                  "cell": "AS14-PAPA-15"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [128.652984, 26.961566],
                    [129.981235, 26.524394],
                    [129.981235, 27.780273],
                    [128.652984, 28.231282],
                    [128.652984, 26.961566]
                  ]
                },
                "properties": {
                  "cell": "AS14-ROMEO-00"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [127.297204, 27.391591],
                    [128.652984, 26.961566],
                    [128.652984, 28.231282],
                    [127.297204, 28.674617],
                    [127.297204, 27.391591]
                  ]
                },
                "properties": {
                  "cell": "AS14-ROMEO-01"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [127.297204, 26.102023],
                    [128.652984, 25.686230],
                    [128.652984, 26.961566],
                    [127.297204, 27.391591],
                    [127.297204, 26.102023]
                  ]
                },
                "properties": {
                  "cell": "AS14-ROMEO-02"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [124.508523, 24.258610],
                    [125.915207, 23.888859],
                    [125.915207, 25.201115],
                    [124.508523, 25.585725],
                    [124.508523, 24.258610]
                  ]
                },
                "properties": {
                  "cell": "AS14-ROMEO-10"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [125.915207, 26.509881],
                    [127.297204, 26.102023],
                    [127.297204, 27.391591],
                    [125.915207, 27.813133],
                    [125.915207, 26.509881]
                  ]
                },
                "properties": {
                  "cell": "AS14-ROMEO-13"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [131.280858, 24.836040],
                    [132.550960, 24.404181],
                    [132.550960, 25.633866],
                    [131.280858, 26.081397],
                    [131.280858, 24.836040]
                  ]
                },
                "properties": {
                  "cell": "AS14-SIERRA-13"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [129.981235, 25.263807],
                    [131.280858, 24.836040],
                    [131.280858, 26.081397],
                    [129.981235, 26.524394],
                    [129.981235, 25.263807]
                  ]
                },
                "properties": {
                  "cell": "AS14-SIERRA-14"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [127.297204, 32.466438],
                    [128.652984, 31.988984],
                    [128.652984, 33.218921],
                    [127.297204, 33.705764],
                    [127.297204, 32.466438]
                  ]
                },
                "properties": {
                  "cell": "AS15-ROMEO-09"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [128.652984, 31.988984],
                    [129.981235, 31.502228],
                    [129.981235, 32.722232],
                    [128.652984, 33.218921],
                    [128.652984, 31.988984]
                  ]
                },
                "properties": {
                  "cell": "AS15-ROMEO-10"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [128.652984, 30.746682],
                    [129.981235, 30.270859],
                    [129.981235, 31.502228],
                    [128.652984, 31.988984],
                    [128.652984, 30.746682]
                  ]
                },
                "properties": {
                  "cell": "AS15-ROMEO-11"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [128.652984, 29.493566],
                    [129.981235, 29.029665],
                    [129.981235, 30.270859],
                    [128.652984, 30.746682],
                    [128.652984, 29.493566]
                  ]
                },
                "properties": {
                  "cell": "AS15-ROMEO-12"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [128.652984, 28.231282],
                    [129.981235, 27.780273],
                    [129.981235, 29.029665],
                    [128.652984, 29.493566],
                    [128.652984, 28.231282]
                  ]
                },
                "properties": {
                  "cell": "AS15-ROMEO-15"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [129.981235, 27.780273],
                    [131.280858, 27.322941],
                    [131.280858, 28.558929],
                    [129.981235, 29.029665],
                    [129.981235, 27.780273]
                  ]
                },
                "properties": {
                  "cell": "AS15-SIERRA-00"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [131.280858, 31.007589],
                    [132.550960, 30.506466],
                    [132.550960, 31.705021],
                    [131.280858, 32.217127],
                    [131.280858, 31.007589]
                  ]
                },
                "properties": {
                  "cell": "AS15-SIERRA-12"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [129.981235, 30.270859],
                    [131.280858, 29.787681],
                    [131.280858, 31.007589],
                    [129.981235, 31.502228],
                    [129.981235, 30.270859]
                  ]
                },
                "properties": {
                  "cell": "AS15-SIERRA-14"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [129.981235, 31.502228],
                    [131.280858, 31.007589],
                    [131.280858, 32.217127],
                    [129.981235, 32.722232],
                    [129.981235, 31.502228]
                  ]
                },
                "properties": {
                  "cell": "AS15-SIERRA-15"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [128.652984, 34.435051],
                    [129.981235, 33.929430],
                    [129.981235, 35.122480],
                    [128.652984, 35.636037],
                    [128.652984, 34.435051]
                  ]
                },
                "properties": {
                  "cell": "AS16-ROMEO-04"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [128.652984, 33.218921],
                    [129.981235, 32.722232],
                    [129.981235, 33.929430],
                    [128.652984, 34.435051],
                    [128.652984, 33.218921]
                  ]
                },
                "properties": {
                  "cell": "AS16-ROMEO-05"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [129.981235, 32.722232],
                    [131.280858, 32.217127],
                    [131.280858, 33.414858],
                    [129.981235, 33.929430],
                    [129.981235, 32.722232]
                  ]
                },
                "properties": {
                  "cell": "AS16-SIERRA-00"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [129.981235, 33.929430],
                    [131.280858, 33.414858],
                    [131.280858, 34.599440],
                    [129.981235, 35.122480],
                    [129.981235, 33.929430]
                  ]
                },
                "properties": {
                  "cell": "AS16-SIERRA-01"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [131.280858, 33.414858],
                    [132.550960, 32.892764],
                    [132.550960, 34.068354],
                    [131.280858, 34.599440],
                    [131.280858, 33.414858]
                  ]
                },
                "properties": {
                  "cell": "AS16-SIERRA-02"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [131.280858, 32.217127],
                    [132.550960, 31.705021],
                    [132.550960, 32.892764],
                    [131.280858, 33.414858],
                    [131.280858, 32.217127]
                  ]
                },
                "properties": {
                  "cell": "AS16-SIERRA-03"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [132.550960, 31.705021],
                    [133.790845, 31.187306],
                    [133.790845, 32.364553],
                    [132.550960, 32.892764],
                    [132.550960, 31.705021]
                  ]
                },
                "properties": {
                  "cell": "AS16-SIERRA-04"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [133.790845, 32.364553],
                    [135.000000, 31.831598],
                    [135.000000, 32.987680],
                    [133.790845, 33.530639],
                    [133.790845, 32.364553]
                  ]
                },
                "properties": {
                  "cell": "AS16-SIERRA-06"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [132.550960, 32.892764],
                    [133.790845, 32.364553],
                    [133.790845, 33.530639],
                    [132.550960, 34.068354],
                    [132.550960, 32.892764]
                  ]
                },
                "properties": {
                  "cell": "AS16-SIERRA-07"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [132.550960, 34.068354],
                    [133.790845, 33.530639],
                    [133.790845, 34.684313],
                    [132.550960, 35.230546],
                    [132.550960, 34.068354]
                  ]
                },
                "properties": {
                  "cell": "AS16-SIERRA-08"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [133.790845, 33.530639],
                    [135.000000, 32.987680],
                    [135.000000, 34.132332],
                    [133.790845, 34.684313],
                    [133.790845, 33.530639]
                  ]
                },
                "properties": {
                  "cell": "AS16-SIERRA-09"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [133.790845, 34.684313],
                    [135.000000, 34.132332],
                    [135.000000, 35.264390],
                    [133.790845, 35.824418],
                    [133.790845, 34.684313]
                  ]
                },
                "properties": {
                  "cell": "AS16-SIERRA-10"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [132.550960, 35.230546],
                    [133.790845, 34.684313],
                    [133.790845, 35.824418],
                    [132.550960, 36.378189],
                    [132.550960, 35.230546]
                  ]
                },
                "properties": {
                  "cell": "AS16-SIERRA-11"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [131.280858, 35.769633],
                    [132.550960, 35.230546],
                    [132.550960, 36.378189],
                    [131.280858, 36.924298],
                    [131.280858, 35.769633]
                  ]
                },
                "properties": {
                  "cell": "AS16-SIERRA-12"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [131.280858, 34.599440],
                    [132.550960, 34.068354],
                    [132.550960, 35.230546],
                    [131.280858, 35.769633],
                    [131.280858, 34.599440]
                  ]
                },
                "properties": {
                  "cell": "AS16-SIERRA-13"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [129.981235, 35.122480],
                    [131.280858, 34.599440],
                    [131.280858, 35.769633],
                    [129.981235, 36.300150],
                    [129.981235, 35.122480]
                  ]
                },
                "properties": {
                  "cell": "AS16-SIERRA-14"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [137.836770, 42.823450],
                    [139.181442, 42.066234],
                    [140.652503, 42.682684],
                    [139.318145, 43.475659],
                    [137.836770, 42.823450]
                  ]
                },
                "properties": {
                  "cell": "NR15-BRAVO-00"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [139.318145, 43.475659],
                    [140.652503, 42.682684],
                    [142.160450, 43.282988],
                    [140.840360, 44.111998],
                    [139.318145, 43.475659]
                  ]
                },
                "properties": {
                  "cell": "NR15-CHARLIE-05"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [140.840360, 44.111998],
                    [142.160450, 43.282988],
                    [143.703758, 43.865229],
                    [142.402119, 44.730369],
                    [140.840360, 44.111998]
                  ]
                },
                "properties": {
                  "cell": "NR15-CHARLIE-06"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [139.465314, 44.935763],
                    [140.840360, 44.111998],
                    [142.402119, 44.730369],
                    [141.042832, 45.591700],
                    [139.465314, 44.935763]
                  ]
                },
                "properties": {
                  "cell": "NR15-CHARLIE-07"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [141.042832, 45.591700],
                    [142.402119, 44.730369],
                    [144.001755, 45.328716],
                    [142.662869, 46.227647],
                    [141.042832, 45.591700]
                  ]
                },
                "properties": {
                  "cell": "NR15-CHARLIE-08"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [142.402119, 44.730369],
                    [143.703758, 43.865229],
                    [145.280565, 44.427550],
                    [144.001755, 45.328716],
                    [142.402119, 44.730369]
                  ]
                },
                "properties": {
                  "cell": "NR15-CHARLIE-09"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [147.306044, 46.457519],
                    [148.525472, 45.485433],
                    [150.188095, 45.977796],
                    [149.005390, 46.984342],
                    [147.306044, 46.457519]
                  ]
                },
                "properties": {
                  "cell": "NR15-DELTA-12"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [145.637215, 45.905060],
                    [146.888658, 44.968173],
                    [148.525472, 45.485433],
                    [147.306044, 46.457519],
                    [145.637215, 45.905060]
                  ]
                },
                "properties": {
                  "cell": "NR15-DELTA-15"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [129.981235, 37.461319],
                    [131.280858, 36.924298],
                    [132.483124, 37.570334],
                    [131.176282, 38.137102],
                    [129.981235, 37.461319]
                  ]
                },
                "properties": {
                  "cell": "NR16-ALPHA-00"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [131.280858, 36.924298],
                    [132.550960, 36.378189],
                    [133.757875, 36.994954],
                    [132.483124, 37.570334],
                    [131.280858, 36.924298]
                  ]
                },
                "properties": {
                  "cell": "NR16-ALPHA-01"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [135.000000, 37.606882],
                    [136.242125, 36.994954],
                    [137.516876, 37.570334],
                    [136.277182, 38.212401],
                    [135.000000, 37.606882]
                  ]
                },
                "properties": {
                  "cell": "NR16-ALPHA-08"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [136.277182, 38.212401],
                    [137.516876, 37.570334],
                    [138.823718, 38.137102],
                    [137.589076, 38.809891],
                    [136.277182, 38.212401]
                  ]
                },
                "properties": {
                  "cell": "NR16-ALPHA-09"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [137.516876, 37.570334],
                    [138.719142, 36.924298],
                    [140.018765, 37.461319],
                    [138.823718, 38.137102],
                    [137.516876, 37.570334]
                  ]
                },
                "properties": {
                  "cell": "NR16-ALPHA-10"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [136.242125, 36.994954],
                    [137.449040, 36.378189],
                    [138.719142, 36.924298],
                    [137.516876, 37.570334],
                    [136.242125, 36.994954]
                  ]
                },
                "properties": {
                  "cell": "NR16-ALPHA-11"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [135.000000, 36.412486],
                    [136.209155, 35.824418],
                    [137.449040, 36.378189],
                    [136.242125, 36.994954],
                    [135.000000, 36.412486]
                  ]
                },
                "properties": {
                  "cell": "NR16-ALPHA-12"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [132.550960, 36.378189],
                    [133.790845, 35.824418],
                    [135.000000, 36.412486],
                    [133.757875, 36.994954],
                    [132.550960, 36.378189]
                  ]
                },
                "properties": {
                  "cell": "NR16-ALPHA-14"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [133.790845, 35.824418],
                    [135.000000, 35.264390],
                    [136.209155, 35.824418],
                    [135.000000, 36.412486],
                    [133.790845, 35.824418]
                  ]
                },
                "properties": {
                  "cell": "NR16-ALPHA-15"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [140.314546, 39.974148],
                    [141.530503, 39.238612],
                    [142.928303, 39.770261],
                    [141.726310, 40.537567],
                    [140.314546, 39.974148]
                  ]
                },
                "properties": {
                  "cell": "NR16-BRAVO-02"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [141.530503, 39.238612],
                    [142.702796, 38.502356],
                    [144.084793, 39.003528],
                    [142.928303, 39.770261],
                    [141.530503, 39.238612]
                  ]
                },
                "properties": {
                  "cell": "NR16-BRAVO-03"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [140.161913, 38.693712],
                    [141.347016, 37.987815],
                    [142.702796, 38.502356],
                    [141.530503, 39.238612],
                    [140.161913, 38.693712]
                  ]
                },
                "properties": {
                  "cell": "NR16-BRAVO-04"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [138.823718, 38.137102],
                    [140.018765, 37.461319],
                    [141.347016, 37.987815],
                    [140.161913, 38.693712],
                    [138.823718, 38.137102]
                  ]
                },
                "properties": {
                  "cell": "NR16-BRAVO-05"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [137.589076, 38.809891],
                    [138.823718, 38.137102],
                    [140.161913, 38.693712],
                    [138.935125, 39.397697],
                    [137.589076, 38.809891]
                  ]
                },
                "properties": {
                  "cell": "NR16-BRAVO-06"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [138.935125, 39.397697],
                    [140.161913, 38.693712],
                    [141.530503, 39.238612],
                    [140.314546, 39.974148],
                    [138.935125, 39.397697]
                  ]
                },
                "properties": {
                  "cell": "NR16-BRAVO-07"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [137.666096, 40.097987],
                    [138.935125, 39.397697],
                    [140.314546, 39.974148],
                    [139.054089, 40.707123],
                    [137.666096, 40.097987]
                  ]
                },
                "properties": {
                  "cell": "NR16-BRAVO-08"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [137.748460, 41.435587],
                    [139.054089, 40.707123],
                    [140.477685, 41.303562],
                    [139.181442, 42.066234],
                    [137.748460, 41.435587]
                  ]
                },
                "properties": {
                  "cell": "NR16-BRAVO-12"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [139.054089, 40.707123],
                    [140.314546, 39.974148],
                    [141.726310, 40.537567],
                    [140.477685, 41.303562],
                    [139.054089, 40.707123]
                  ]
                },
                "properties": {
                  "cell": "NR16-BRAVO-13"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [140.477685, 41.303562],
                    [141.726310, 40.537567],
                    [143.169132, 41.086293],
                    [141.935777, 41.885495],
                    [140.477685, 41.303562]
                  ]
                },
                "properties": {
                  "cell": "NR16-BRAVO-14"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [139.181442, 42.066234],
                    [140.477685, 41.303562],
                    [141.935777, 41.885495],
                    [140.652503, 42.682684],
                    [139.181442, 42.066234]
                  ]
                },
                "properties": {
                  "cell": "NR16-BRAVO-15"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [145.280565, 44.427550],
                    [146.501556, 43.526658],
                    [148.080629, 44.033283],
                    [146.888658, 44.968173],
                    [145.280565, 44.427550]
                  ]
                },
                "properties": {
                  "cell": "NR16-CHARLIE-05"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [143.703758, 43.865229],
                    [144.949564, 42.998748],
                    [146.501556, 43.526658],
                    [145.280565, 44.427550],
                    [143.703758, 43.865229]
                  ]
                },
                "properties": {
                  "cell": "NR16-CHARLIE-06"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [144.949564, 42.998748],
                    [146.141471, 42.133222],
                    [147.667060, 42.628360],
                    [146.501556, 43.526658],
                    [144.949564, 42.998748]
                  ]
                },
                "properties": {
                  "cell": "NR16-CHARLIE-07"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [143.426969, 42.451137],
                    [144.641461, 41.618702],
                    [146.141471, 42.133222],
                    [144.949564, 42.998748],
                    [143.426969, 42.451137]
                  ]
                },
                "properties": {
                  "cell": "NR16-CHARLIE-08"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [142.160450, 43.282988],
                    [143.426969, 42.451137],
                    [144.949564, 42.998748],
                    [143.703758, 43.865229],
                    [142.160450, 43.282988]
                  ]
                },
                "properties": {
                  "cell": "NR16-CHARLIE-09"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [140.652503, 42.682684],
                    [141.935777, 41.885495],
                    [143.426969, 42.451137],
                    [142.160450, 43.282988],
                    [140.652503, 42.682684]
                  ]
                },
                "properties": {
                  "cell": "NR16-CHARLIE-10"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [141.935777, 41.885495],
                    [143.169132, 41.086293],
                    [144.641461, 41.618702],
                    [143.426969, 42.451137],
                    [141.935777, 41.885495]
                  ]
                },
                "properties": {
                  "cell": "NR16-CHARLIE-11"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [146.888658, 44.968173],
                    [148.080629, 44.033283],
                    [149.684159, 44.517157],
                    [148.525472, 45.485433],
                    [146.888658, 44.968173]
                  ]
                },
                "properties": {
                  "cell": "NR16-DELTA-00"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [148.525472, 45.485433],
                    [149.684159, 44.517157],
                    [151.309225, 44.976946],
                    [150.188095, 45.977796],
                    [148.525472, 45.485433]
                  ]
                },
                "properties": {
                  "cell": "NR16-DELTA-03"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [135.000000, 35.264390],
                    [135.000000, 34.132332],
                    [136.209155, 34.684313],
                    [136.209155, 35.824418],
                    [135.000000, 35.264390]
                  ]
                },
                "properties": {
                  "cell": "PA01-ALPHA-00"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [136.209155, 35.824418],
                    [136.209155, 34.684313],
                    [137.449040, 35.230546],
                    [137.449040, 36.378189],
                    [136.209155, 35.824418]
                  ]
                },
                "properties": {
                  "cell": "PA01-ALPHA-01"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [136.209155, 34.684313],
                    [136.209155, 33.530639],
                    [137.449040, 34.068354],
                    [137.449040, 35.230546],
                    [136.209155, 34.684313]
                  ]
                },
                "properties": {
                  "cell": "PA01-ALPHA-02"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [135.000000, 34.132332],
                    [135.000000, 32.987680],
                    [136.209155, 33.530639],
                    [136.209155, 34.684313],
                    [135.000000, 34.132332]
                  ]
                },
                "properties": {
                  "cell": "PA01-ALPHA-03"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [138.719142, 33.414858],
                    [138.719142, 32.217127],
                    [140.018765, 32.722232],
                    [140.018765, 33.929430],
                    [138.719142, 33.414858]
                  ]
                },
                "properties": {
                  "cell": "PA01-ALPHA-10"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [138.719142, 34.599440],
                    [138.719142, 33.414858],
                    [140.018765, 33.929430],
                    [140.018765, 35.122480],
                    [138.719142, 34.599440]
                  ]
                },
                "properties": {
                  "cell": "PA01-ALPHA-11"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [138.719142, 35.769633],
                    [138.719142, 34.599440],
                    [140.018765, 35.122480],
                    [140.018765, 36.300150],
                    [138.719142, 35.769633]
                  ]
                },
                "properties": {
                  "cell": "PA01-ALPHA-12"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [137.449040, 35.230546],
                    [137.449040, 34.068354],
                    [138.719142, 34.599440],
                    [138.719142, 35.769633],
                    [137.449040, 35.230546]
                  ]
                },
                "properties": {
                  "cell": "PA01-ALPHA-13"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [137.449040, 36.378189],
                    [137.449040, 35.230546],
                    [138.719142, 35.769633],
                    [138.719142, 36.924298],
                    [137.449040, 36.378189]
                  ]
                },
                "properties": {
                  "cell": "PA01-ALPHA-14"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [138.719142, 36.924298],
                    [138.719142, 35.769633],
                    [140.018765, 36.300150],
                    [140.018765, 37.461319],
                    [138.719142, 36.924298]
                  ]
                },
                "properties": {
                  "cell": "PA01-ALPHA-15"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [138.719142, 32.217127],
                    [138.719142, 31.007589],
                    [140.018765, 31.502228],
                    [140.018765, 32.722232],
                    [138.719142, 32.217127]
                  ]
                },
                "properties": {
                  "cell": "PA01-BRAVO-05"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [140.018765, 37.461319],
                    [140.018765, 36.300150],
                    [141.347016, 36.820660],
                    [141.347016, 37.987815],
                    [140.018765, 37.461319]
                  ]
                },
                "properties": {
                  "cell": "PA02-ALPHA-00"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [140.018765, 36.300150],
                    [140.018765, 35.122480],
                    [141.347016, 35.636037],
                    [141.347016, 36.820660],
                    [140.018765, 36.300150]
                  ]
                },
                "properties": {
                  "cell": "PA02-ALPHA-01"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [140.018765, 35.122480],
                    [140.018765, 33.929430],
                    [141.347016, 34.435051],
                    [141.347016, 35.636037],
                    [140.018765, 35.122480]
                  ]
                },
                "properties": {
                  "cell": "PA02-ALPHA-14"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [140.018765, 25.263807],
                    [140.018765, 24.000351],
                    [141.347016, 24.407155],
                    [141.347016, 25.686230],
                    [140.018765, 25.263807]
                  ]
                },
                "properties": {
                  "cell": "PA02-CHARLIE-06"
                }
              }, {
                "type": "Feature",
                "geometry": {
                  "type": "LineString",
                  "coordinates": [
                    [141.347016, 26.961566],
                    [141.347016, 25.686230],
                    [142.702796, 26.102023],
                    [142.702796, 27.391591],
                    [141.347016, 26.961566]
                  ]
                },
                "properties": {
                  "cell": "PA02-CHARLIE-08"
                }
              }]
            }
          });
          map.addLayer({
            'id': 'cells',
            'type': 'line',
            'source': 'cells',
            'layout': {
              'line-join': 'round',
              'line-cap': 'round'
            },
            'paint': {
              'line-color': '#ffa500',
              'line-opacity': 0.5,
              'line-width': 2,
            }
          });
          map.addLayer({
            'id': 'csvData',
            'type': 'circle',
            'source': {
              'type': 'geojson',
              'data': data
            },
            'paint': {
              'circle-radius': 3.5,
              'circle-color': '#ff0099',
              'circle-stroke-width': 1.0,
              'circle-stroke-color': '#222222'
            },
            'filter': ['==', '$type', 'Point'],
          });
          map.on('click', 'csvData', function (e) {
            var coordinates = e.features[0].geometry.coordinates.slice();
            var description = `<h3>` + e.features[0].properties.title + `</h3>` + `<h4>` + `<b>` + `Location: ` + `</b>` + e.features[0].properties.location + `</h4>` + `<h4>` + `<b>` + `Intel: ` + `</b><a href="` + e.features[0].properties.intel + `">` + e.features[0].properties.intel + `</a></h4>` + `<img src="` + e.features[0].properties.image + `">`;
            while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
              coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
            }
            new mapboxgl.Popup().setLngLat(coordinates).setHTML(description).addTo(map);
          });
          map.on('mouseenter', 'csvData', function () {
            map.getCanvas().style.cursor = 'pointer';
          });
          map.on('mouseleave', 'places', function () {
            map.getCanvas().style.cursor = '';
          });
          var bbox = turf.bbox(data);
          map.fitBounds(bbox, {
            padding: 50
          });
        });
      });
    };
  });
  </script>
</body>
</html>
